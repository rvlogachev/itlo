$(function(){var e=$(".upload-wrapper");function a(e,a){var r=a.name,t=a.type?a.type+", ":"",o=function(e){if(0==e)return"0 Byte";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,a),2)+" "+["Bytes","Kb","Mb","Gb","Tb"][a]}(a.size),n=function(e){switch(e){case"image/bmp":return"icon-image-bmp";case"image/gif":return"icon-image-gif";case"image/jpeg":return"icon-image-jpeg";case"image/png":return"icon-image-png";case"image/svg":return"icon-image-svg";case"image/tiff":return"icon-image-tiff";case"image/webp":return"icon-image-webp";case"video/avi":return"icon-video-avi";case"video/mkv":return"icon-video-mkv";case"video/mov":return"icon-video-mov";case"video/mp4":return"icon-video-mp4";case"video/mpeg":return"icon-video-mpeg";case"video/ogv":return"icon-video-ogv";case"video/webm":return"icon-video-webm";case"video/wmv":return"icon-video-wmv";case"audio/aac":return"icon-audio-aac";case"audio/mka":return"icon-audio-mka";case"audio/mp3":return"icon-audio-mp3";case"audio/mp4":return"icon-audio-mp4";case"audio/ogg":return"icon-audio-ogg";case"audio/rm":return"icon-audio-rm";case"audio/wav":return"icon-audio-wav";case"audio/weba":return"icon-audio-weba";case"audio/wma":return"icon-audio-wma";case"document/csv":return"icon-document-csv";case"document/doc":return"icon-document-doc";case"document/json":return"icon-document-json";case"document/odf":return"icon-document-odf";case"document/odp":return"icon-document-odp";case"document/ods":return"icon-document-ods";case"document/pdf":return"icon-document-pdf";case"document/ppt":return"icon-document-ppt";case"document/rtf":return"icon-document-rtf";case"document/txt":return"icon-document-txt";case"document/xls":return"icon-document-xls";default:return"icon-unknown"}}(a.type);$(e).append('<div data-upload="'+r+'"><span class="icon icon-filetype icon-sm '+n+'"></span> '+r+' <span class="text-muted">('+t+o+')</span><div class="progress" style="height:3px;"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div></div>')}function r(e,a,r){var t=$('[data-upload="'+e+'"]').find(".progress > .progress-bar");"process"==r?t.addClass("progress-bar-primary").addClass("progress-bar-striped"):"success"==r?t.addClass("progress-bar-success").removeClass("progress-bar-striped"):"error"==r?t.addClass("progress-bar-danger").removeClass("progress-bar-striped"):t.removeClass("progress-bar-striped"),t.attr("aria-valuenow",parseInt(a)),t.css("width",parseInt(a)+"%")}function t(e,a,t,o){var n=window.location.href;$(e).attr("action")&&(n=$(e).attr("action"));var s="POST";$(e).attr("method")&&(s=$(e).attr("method"));var i=new FormData;if($(e).get(0)&&(i=new FormData(e.get(0))),n&&s&&e&&i&&a&&t){var c=new XMLHttpRequest;c.open(s,n,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Accept","application/json"),c.upload.addEventListener("progress",function(e){r(t.name,100*e.loaded/e.total||100,"process")}),c.addEventListener("readystatechange",function(e){if(console.log(c.responseText),4==c.readyState&&200==c.status){var a=JSON.parse(c.responseText);"object"==typeof a[t.name]?1==a[t.name].status&&r(t.name,100,"success"):r(t.name,100,"error")}else 4==c.readyState&&200!=c.status&&r(t.name,100,"error")});var d=!1;for(var u of i.entries())u[0]===a&&(d=!0);return d?i.set(a,t):i.append(a,t),c.send(i)}return!1}e.length>0&&e.each(function(e,r){var o=$(r),n=o.parent("form"),s=o.find('input[type="file"]'),i=$('<div class="upload-filelist" />');o.after(i),o.on("dragenter dragover",function(e){e.preventDefault(),e.stopPropagation();var a=$(e.currentTarget);$(a).addClass("has-drag")}),o.on("dragleave",function(e){e.preventDefault(),e.stopPropagation();var a=$(e.currentTarget);$(a).removeClass("has-drag")}),o.on("drop",function(e){e.preventDefault(),e.stopPropagation();var r=$(e.currentTarget);$(r).removeClass("has-drag");for(var o=e.originalEvent.dataTransfer.files,c=0;c<o.length;c++){var d=o[c];a(i,d),t(n,s.attr("name"),d)}}),s.change(function(){for(var e=$(this)[0].files,r=0;r<e.length;r++){var o=e[r];a(i,o),t(n,s.attr("name"),o)}})})});
//# sourceMappingURL=media.js.map