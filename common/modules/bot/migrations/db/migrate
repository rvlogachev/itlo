CREATE TABLE `ben_bot_log` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`update_id` INT(50) NULL DEFAULT NULL,
	`is_callback` INT(50) NULL DEFAULT NULL,
	`callback_query_id` VARCHAR(100) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_id` INT(50) NULL DEFAULT NULL,
	`callback_query_from_is_bot` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_language_code` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_chat_instance` INT(50) NULL DEFAULT NULL,
	`callback_data` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`message_id` INT(50) NULL DEFAULT NULL,
	`from_id` INT(50) NULL DEFAULT NULL,
	`from_is_bot` INT(11) NULL DEFAULT NULL,
	`from_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`from_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`from_language_code` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_id` INT(50) NULL DEFAULT NULL,
	`chat_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_type` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`date` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`text` TEXT NULL COLLATE 'utf8_unicode_ci',
	`entities` TEXT NULL COLLATE 'utf8_unicode_ci',
	PRIMARY KEY (`id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
;


CREATE TABLE `ben_buttons` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`updated_at` INT(11) NULL DEFAULT NULL,
	`created_at` INT(11) NULL DEFAULT NULL,
	`key` VARCHAR(50) NULL DEFAULT NULL,
	`type` VARCHAR(50) NULL DEFAULT NULL,
	`size` VARCHAR(50) NULL DEFAULT NULL,
	`callback_data` VARCHAR(150) NULL DEFAULT NULL,
	`text` VARCHAR(150) NULL DEFAULT NULL,
	`url` VARCHAR(500) NULL DEFAULT NULL,
	`status` INT(11) NULL DEFAULT NULL,
	`widget_text_id` INT(11) NULL DEFAULT NULL,
	`request_contact` INT(11) NULL DEFAULT '0',
	`request_location` INT(11) NULL DEFAULT '0',
	PRIMARY KEY (`id`),
	INDEX `FK_ben_buttons_widget_text` (`widget_text_id`),
	CONSTRAINT `FK_ben_buttons_widget_text` FOREIGN KEY (`widget_text_id`) REFERENCES `widget_text` (`id`) ON UPDATE CASCADE ON DELETE CASCADE
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;




CREATE TABLE `ben_screens` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`key` VARCHAR(255) NOT NULL COLLATE 'utf8_unicode_ci',
	`title` VARCHAR(255) NOT NULL COLLATE 'utf8_unicode_ci',
	`body` TEXT NULL COLLATE 'utf8_unicode_ci',
	`status` SMALLINT(6) NULL DEFAULT NULL,
	`created_at` INT(11) NULL DEFAULT NULL,
	`updated_at` INT(11) NULL DEFAULT NULL,
	`buttons` TEXT NULL COLLATE 'utf8_unicode_ci',
	`is_start` INT(11) NULL DEFAULT NULL,
	PRIMARY KEY (`id`),
	INDEX `idx_ben_screens_key` (`key`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
;




CREATE TABLE `ben_widget_text` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`key` VARCHAR(255) NOT NULL COLLATE 'utf8_unicode_ci',
	`title` VARCHAR(255) NOT NULL COLLATE 'utf8_unicode_ci',
	`body` TEXT NULL COLLATE 'utf8_unicode_ci',
	`status` SMALLINT(6) NULL DEFAULT NULL,
	`created_at` INT(11) NULL DEFAULT NULL,
	`updated_at` INT(11) NULL DEFAULT NULL,
	`images` VARCHAR(1024) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`screens_id` INT(11) NULL DEFAULT NULL,
	`sort` INT(11) NULL DEFAULT NULL,
	`buttons` TEXT NULL COLLATE 'utf8_unicode_ci',
	PRIMARY KEY (`id`),
	INDEX `idx_ben_widget_text_key` (`key`),
	INDEX `FK_ben_widget_text_screens` (`screens_id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
;




CREATE TABLE `bot_log` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`update_id` INT(50) NULL DEFAULT NULL,
	`is_callback` INT(50) NULL DEFAULT NULL,
	`callback_query_id` VARCHAR(100) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_id` INT(50) NULL DEFAULT NULL,
	`callback_query_from_is_bot` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_query_from_language_code` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`callback_chat_instance` INT(50) NULL DEFAULT NULL,
	`callback_data` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`message_id` INT(50) NULL DEFAULT NULL,
	`from_id` INT(50) NULL DEFAULT NULL,
	`from_is_bot` INT(11) NULL DEFAULT NULL,
	`from_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`from_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`from_language_code` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_id` INT(50) NULL DEFAULT NULL,
	`chat_first_name` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_username` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`chat_type` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`date` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
	`text` TEXT NULL COLLATE 'utf8_unicode_ci',
	`entities` TEXT NULL COLLATE 'utf8_unicode_ci',
	PRIMARY KEY (`id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
AUTO_INCREMENT=3243
;




CREATE DEFINER=`root`@`%` TRIGGER `after_buttons_insert` AFTER INSERT ON `buttons` FOR EACH ROW BEGIN
      
       INSERT into screens  ( `key`, `title`, `body`, `status`, `created_at`, `updated_at`, `buttons`, `is_start`) 
		 VALUES (NEW.callback_data, NEW.text, NEW.text,  1,now(), now(), NULL, 0); 
		 
  END
